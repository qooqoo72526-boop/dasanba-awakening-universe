
<!doctype html><html lang="zh-Hant">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>é›²é–“ä¿¡ä»¶</title>
<link rel="stylesheet" href="/css/styles.css"/>
<script src="/js/scripts.js" defer></script>
<style>
.wrap{width:min(1100px,95vw);margin:20px auto}
.tabs{display:flex;gap:10px;margin-bottom:12px;justify-content:center}
.tabs .chip{cursor:pointer}
.msgs{display:flex;flex-direction:column;gap:10px}
.b{align-self:flex-start}.m{align-self:flex-end}
.b,.m{max-width:80%;}
.b .cloud{border-color:#ffe06640}.m .cloud{border-color:#9ecbff40}
.input{display:flex;gap:10px;margin-top:12px}
.input input{flex:1;padding:12px 14px;border-radius:14px;border:1px solid #ffffff22;background:linear-gradient(180deg,#101a2f,#0b1324);color:#e9f0ff}
.input button{padding:12px 14px;border-radius:14px;border:1px solid #ffffff22;background:linear-gradient(180deg,#1f2a44,#121a2e);color:#e9f0ff}
</style>
</head>
<body>
<div class="starfield"></div>
<nav class="nav">
  <span class="chip" onclick="go('/index.html')">â† è¿”å›</span>
  <span class="chip active">âœ‰ï¸ é›²é–“ä¿¡ä»¶</span>
  <span class="chip" onclick="go('/soulmirror.html')">ğŸª éˆé­‚ç…§å¦–é¡</span>
</nav>

<section class="wrap">
  <div class="tabs">
    <span class="chip active" id="p-Ajin" onclick="setP('Ajin')">ğŸ’› AJIN</span>
    <span class="chip" id="p-Migou" onclick="setP('Migou')">ğŸ©· MIGOU</span>
    <span class="chip" id="p-Gungun" onclick="setP('Gungun')">ğŸ©µ GUNGUN</span>
  </div>

  <div id="msgs" class="msgs">
    <div class="b"><div class="cloud">é¸å¥½äº†å—ï¼Ÿæˆ‘å€‘ç›´æ¥èŠçœŸå¿ƒè©±ã€‚</div></div>
  </div>

  <div class="input">
    <input id="text" placeholder="è¼¸å…¥è¨Šæ¯â€¦" />
    <button onclick="send()">é€å‡º</button>
  </div>
</section>

<script>
let persona = 'Ajin';
function setP(p){
  persona=p;
  for(const id of ['Ajin','Migou','Gungun']){
    document.getElementById('p-'+id).classList.toggle('active', id===p);
  }
}
async function send(){
  const t = document.getElementById('text');
  const v = t.value.trim();
  if(!v) return;
  const msgs = document.getElementById('msgs');
  msgs.insertAdjacentHTML('beforeend', `<div class="m"><div class="cloud">${v}</div></div>`);
  t.value='';
  const placeholder = document.createElement('div');
  placeholder.className='b';
  placeholder.innerHTML = '<div class="cloud">â€¦</div>';
  msgs.appendChild(placeholder);
  try{
    const r = await fetch('/api/chat', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({persona, message:v})});
    const data = await r.json();
    placeholder.innerHTML = `<div class="cloud">${(data.reply||'(æˆ‘åœ¨è½ï¼Œä½ å†èªªä¸€æ¬¡)')}</div>`;
  }catch(e){
    placeholder.innerHTML = `<div class="cloud">(æš«æ™‚é€£ä¸ä¸Šå®‡å®™è¨Šè™Ÿï¼Œç­‰ä¸€ä¸‹å†è©¦)</div>`;
  }
}
</script>
</body></html>
