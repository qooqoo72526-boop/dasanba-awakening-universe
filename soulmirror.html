<!-- /soulmirror.html -->
<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>éˆé­‚ç…§å¦–é¡</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css"/>
  <style>
    .q-wrap{max-width:1100px; margin:20px auto}
    .q-grid{display:grid; grid-template-columns:repeat(2,1fr); gap:12px}
    .q{background:var(--glass); padding:12px 14px; border-radius:14px}
    .opt{display:flex; gap:10px; margin-top:8px; flex-wrap:wrap}
    .chip{padding:6px 10px; border-radius:18px; background:var(--glass2); cursor:pointer; user-select:none}
    .chip.sel{outline:1px solid rgba(255,255,255,.35)}
    .submit{margin:16px 0; padding:10px 16px; border:none; border-radius:12px; background:var(--accent); color:#fff; font-weight:700}
    @media(max-width:980px){.q-grid{grid-template-columns:1fr}}
  </style>
</head>
<body class="bg-cosmic">
  <div class="container q-wrap">
    <h1 class="brand-en" style="font-family:Orbitron">ğŸª éˆé­‚ç…§å¦–é¡ Â· SOUL MIRROR</h1>
    <div id="qgrid" class="q-grid"></div>
    <button id="go" class="submit">ç”Ÿæˆè§£æ</button>
    <div id="result" class="bubble" style="display:none; margin-top:14px"></div>
  </div>

  <script>
    // ç°¡åŒ–ç¤ºä¾‹é¡Œåº«ï¼ˆå¯å†æ“´å…… 500 é¡Œï¼‰
    const bank = [
      "åœ¨æœ€è¿‘ä¸€æ¬¡å—æŒ«è£¡ï¼Œä½ çœŸæ­£å®³æ€•çš„æ˜¯ä»€éº¼ï¼Ÿ",
      "ç•¶ä½ è¡¨ç¾å‡ºå …å¼·æ™‚ï¼Œä½ å…¶å¯¦æœ€æƒ³è¢«èª°ç†è§£ï¼Ÿ",
      "å¦‚æœè¦å®ˆä½é‚Šç•Œï¼Œæ­¤åˆ»ä½ æƒ³å°èª°èªªã€ä¸ã€ï¼Ÿ",
      "ä½ æœ€å¸¸é€ƒé¿çš„æƒ…ç·’æ˜¯ä»€éº¼ï¼Ÿå®ƒåœ¨ä¿è­·ä½ ä»€éº¼ï¼Ÿ",
      "åœ¨æ„›è£¡ï¼Œä½ æœ€æƒ³ä¿æœ‰çš„ä¸»æ¬Šæ˜¯ä»€éº¼ï¼Ÿ",
      "å“ªä¸€å€‹ç¿’æ…£è®“ä½ ä»¥ç‚ºå®‰å…¨ã€å…¶å¯¦è®“ä½ æ›´å­¤å–®ï¼Ÿ",
      "ä½ å¸Œæœ›è¢«çœ‹è¦‹çš„å„ªé»ï¼Œæœ€å¸¸è¢«èª¤æœƒæˆä»€éº¼ï¼Ÿ",
      "æœ€è¿‘è®“ä½ å¾ˆæœ‰ç”Ÿå‘½åŠ›çš„ä¸€ä»¶å°äº‹æ˜¯ï¼Ÿ",
      "å¦‚æœä»Šå¤©é‡ä¾†ä¸€æ¬¡ï¼Œä½ æœƒå°è‡ªå·±å¤šä¸€åˆ†ä»€éº¼ï¼Ÿ",
      "ä½ å®³æ€•å¤±å»çš„ï¼Œå…¶å¯¦å¾æ²’çœŸæ­£æ“æœ‰éå—ï¼Ÿ",
      // â€¦å¯è‡ªè¡Œæ“´å……
    ];

    const symbols = ['ğŸ¬','ğŸŒ™','ğŸ”·','âœ¨'];
    const qgrid = document.getElementById('qgrid');

    // å– 25 é¡Œï¼ˆä¸é‡è¤‡ï¼‰
    function pick25(){
      const pool = [...bank];
      const out = [];
      while (out.length < 25) {
        const i = Math.floor(Math.random()*pool.length);
        out.push(pool.splice(i,1)[0] || `è‡ªç”±é¡Œ #${out.length+1}`);
      }
      return out;
    }

    const questions = pick25();
    const answers = [];

    questions.forEach((q,idx)=>{
      const div = document.createElement('div'); div.className='q';
      div.innerHTML = `<div><b>Q${idx+1}.</b> ${q}</div><div class="opt"></div>`;
      const opt = div.querySelector('.opt');
      symbols.forEach((s,i)=>{
        const c = document.createElement('span'); c.className='chip'; c.textContent=s;
        c.onclick = ()=>{ [...opt.children].forEach(x=>x.classList.remove('sel')); c.classList.add('sel'); answers[idx] = s; };
        opt.appendChild(c);
      });
      qgrid.appendChild(div);
    });

    document.getElementById('go').onclick = async ()=>{
      const payload = questions.map((q,i)=>`Q${i+1}:${q}\nA:${answers[i]||'ï¼ˆæœªé¸ï¼‰'}`).join('\n\n');
      const result = document.getElementById('result');
      result.style.display='block';
      result.textContent='è§£æç”Ÿæˆä¸­â€¦';

      try{
        const r = await fetch('/api/chat.js',{method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({
            persona:'Migou',
            message:'è«‹ä»¥ 600 å­—ï¼Œæ•´åˆä¸‹é¢ 25 é¡Œçš„è±¡å¾µé¸æ“‡ï¼Œåšä¸€æ®µæ·±å±¤è¦ºé†’å¼è§£æï¼›èªæ°£æ•¢æ„›æ•¢æ¨ã€ç›´æŒ‡æ ¸å¿ƒï¼Œä½†ä¸æ”»æ“Šã€‚æœ€å¾Œè«‹åŠ ä¸Šï¼šé˜¿é‡‘ä¸€å¥è©±ã€ç±³æœä¸€å¥è©±ã€æ»¾æ»¾ä¸€å¥è©±ï¼ˆå„ 1 å¥å³å¯ï¼‰ã€‚\n\n' + payload,
            history:[]
          })
        });
        const data = await r.json();
        result.textContent = data.reply || 'æˆ‘åœ¨ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚';
      }catch(e){
        result.textContent = 'æˆ‘é‚„åœ¨ï¼Œç¶²è·¯å‰›å‰›æ™ƒäº†ä¸€ä¸‹ã€‚å†é»ä¸€æ¬¡ç”Ÿæˆè§£æå°±å¥½ã€‚';
      }
    };
  </script>
</body>
</html>
