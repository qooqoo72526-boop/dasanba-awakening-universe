<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>靈魂照妖鏡｜Soul Mirror</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/css/universe_soul.css" />
</head>
<body class="soulmirror-body">
  <div id="soulmirror-root">
    <!-- 頂部標題 -->
    <header class="soul-header">
      <div class="soul-title-block">
        <div class="soul-tag">SOUL MIRROR / VISION LOG</div>
        <h1 class="soul-title-en">SOUL MIRROR｜SYSTEM VIEW</h1>
        <h2 class="soul-title-zh">今天的你，長這樣。</h2>
      </div>
      <div class="soul-status">
        <span id="question-count">0 / 25</span>
        <span id="answer-status">鏡面還沒被觸碰。</span>
      </div>
    </header>

    <!-- 主視覺 -->
    <main class="soul-main">
      <!-- 背景星塵＋法陣 -->
      <div class="soul-bg-layer">
        <canvas id="soul-stars"></canvas>
        <div class="soul-core-ring core-1"></div>
        <div class="soul-core-ring core-2"></div>
        <div class="soul-core-ring core-3"></div>
      </div>

      <!-- 題目節點：這版改成垂直排在中間 -->
      <div
        class="soul-node-layer"
        id="soul-node-layer"
        style="
          position: relative;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 10px;
          padding: 30px 24px;
          max-height: 420px;
          overflow-y: auto;
        "
      ></div>

      <!-- 中央題目 HUD -->
      <section class="soul-focus-layer" id="soul-focus-layer" aria-hidden="true">
        <div class="soul-focus-panel">
          <div class="soul-focus-halo"></div>
          <div class="soul-focus-inner">
            <div class="soul-focus-label">CURRENT VIEW</div>
            <p class="soul-focus-question" id="focus-question-text"></p>

            <div class="soul-answer-block">
              <div class="soul-scale-label">
                <span>有一點像</span>
                <span>超級就是我</span>
              </div>
              <div class="soul-answer-options" id="answer-options"></div>
            </div>

            <div class="soul-focus-actions">
              <button id="btn-skip" class="btn-ghost">先放過這題</button>
              <button id="btn-save-answer" class="btn-primary" disabled>
                就照這樣記
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- 結果層 -->
      <section class="soul-result-layer" id="soul-result-layer" aria-hidden="true">
        <div class="soul-result-panel">
          <div class="soul-result-halo"></div>
          <div class="soul-result-inner">
            <div class="soul-result-tag">MIRROR LOG</div>
            <h3 class="soul-result-title">這是你的鏡面紀錄。</h3>
            <p class="soul-result-meta" id="soul-result-meta">
              不是定義，只是今天被看見的那一版你。
            </p>

            <div class="soul-result-text" id="soul-result-text"></div>

            <div class="soul-result-birds" id="soul-result-birds"></div>

            <div class="soul-result-actions">
              <button id="btn-close-result" class="btn-ghost">收回鏡面</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- 底部操作 -->
    <footer class="soul-footer">
      <button id="btn-generate-questions" class="btn-outline">
        換一組 25 題
      </button>
      <button id="btn-start-analysis" class="btn-primary" disabled>
        看今天的結果
      </button>
    </footer>
  </div>

  <script>
  // ✅ 這版只做兩件事：
  // 1) 畫星星
  // 2) 把 25 題用「一排按鈕」塞進中間

  document.addEventListener("DOMContentLoaded", function () {
    console.log("Soul Mirror minimal JS loaded.");

    var nodeLayer = document.getElementById("soul-node-layer");
    if (!nodeLayer) {
      alert("找不到 #soul-node-layer");
      return;
    }

    // 讓容器一定是垂直可捲的區塊
    nodeLayer.style.position = "relative";
    nodeLayer.style.display = "flex";
    nodeLayer.style.flexDirection = "column";
    nodeLayer.style.alignItems = "stretch";
    nodeLayer.style.justifyContent = "flex-start";
    nodeLayer.style.gap = "8px";
    nodeLayer.style.padding = "24px 20px";
    nodeLayer.style.maxHeight = "420px";
    nodeLayer.style.overflowY = "auto";

    var questions = [
      "你最害怕被看見的那一面，是什麼？為什麼？",
      "當別人不回應你時，你腦中會自動補出什麼劇本？",
      "你曾為了不被討厭，而說過違背內心的話嗎？哪一次最印象深刻？",
      "在親密關係裡，你最常扮演的角色是照顧者、調停者、還是抽離的人？",
      "如果今天所有責任都暫停 24 小時，你最想用什麼樣子存在？",
      "童年時，哪一個畫面讓你學會「不能太做自己」？",
      "你最容易為了哪一種人，委屈自己到失去界線？",
      "當你生氣時，通常是什麼情緒被踩到，而不是單純的憤怒？",
      "你是否曾經把「被需要」和「被愛」搞混？那造成了什麼？",
      "你現在最怕失去的是什麼？如果真的失去了，你覺得自己會變成怎樣？",
      "你有沒有一個一直沒說出口的遺憾，如果能重來，你會對誰說什麼？",
      "你什麼時候最像在逃避自己？是滑手機、工作過量，還是假裝沒感覺？",
      "你習慣先照顧別人的情緒，還是先誠實面對自己的需求？為什麼？",
      "你曾經在哪一段關係裡，用力到忘記自己其實也有權利被照顧？",
      "當你被誤解時，你是選擇解釋、沉默，還是直接抽離？背後的恐懼是什麼？",
      "你覺得「被愛」對你來說最具體的樣子，是什麼畫面？",
      "如果現在的你可以對十年前的自己說一句話，你會說什麼？",
      "你有沒有那種「其實早就知道該離開，卻一直不敢動」的場景？",
      "你最常用哪一種方式懲罰自己？（忽略、否定、過度要求，或是別的？）",
      "當你說「沒事啦」的時候，心裡真正的話其實是什麼？",
      "別人給過你最溫柔的一句話是什麼？你相信它嗎？",
      "你理想中的安全感，是來自金錢、關係、能力，還是被理解？",
      "你有沒有哪一個選擇，是當時看起來很理性，但現在回頭覺得那是自我背叛？",
      "你曾經在哪件事情上，感覺自己「很值得」，而不是「好不容易被選上」？",
      "如果可以把一種情緒從你的人生降低 50%，你會選哪一種？"
    ];

    // 確保只有 25 題
    if (questions.length > 25) {
      questions = questions.slice(0, 25);
    }

    // 把 25 題變成 25 個按鈕
    questions.forEach(function (text, index) {
      var btn = document.createElement("button");
      btn.type = "button";
      btn.className = "soul-node";
      btn.style.position = "relative";
      btn.style.left = "auto";
      btn.style.top = "auto";
      btn.style.transform = "none";
      btn.style.textAlign = "left";

      btn.textContent = (index + 1) + ". " + text;

      // 先用超簡單互動：點一下跳出 alert（只是確認點得到）
      btn.addEventListener("click", function () {
        alert("第 " + (index + 1) + " 題：\n" + text);
      });

      nodeLayer.appendChild(btn);
    });

    // 畫星星（沿用原本）
    drawStars();
  });

  // 星塵動畫
  function drawStars() {
    var canvas = document.getElementById("soul-stars");
    if (!canvas) return;
    var ctx = canvas.getContext("2d");
    var w = (canvas.width =
      canvas.offsetWidth || canvas.clientWidth || window.innerWidth || 800);
    var h = (canvas.height =
      canvas.offsetHeight || canvas.clientHeight || window.innerHeight || 480);

    var stars = [];
    var count = 140;
    for (var i = 0; i < count; i++) {
      stars.push({
        x: Math.random() * w,
        y: Math.random() * h,
        r: Math.random() * 1.2 + 0.3,
        a: Math.random() * Math.PI * 2,
        s: Math.random() * 0.4 + 0.05
      });
    }

    function step() {
      ctx.clearRect(0, 0, w, h);
      ctx.fillStyle = "#ffffff";
      for (var i = 0; i < stars.length; i++) {
        var star = stars[i];
        star.a += star.s * 0.02;
        var alpha = 0.2 + 0.6 * (0.5 + 0.5 * Math.sin(star.a));
        ctx.globalAlpha = alpha;
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
        ctx.fill();
      }
      requestAnimationFrame(step);
    }
    step();
  }
</script>
