<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cosmic Post Station</title>
  <link rel="stylesheet" href="css/universe_v916.css">
  <link rel="stylesheet" href="css/style_v916.css">
</head>
<body data-universe="home">
  <div class="cosmic-bg"></div>
  <canvas id="stars"></canvas>
  <nav class="nav-micro">
    <a href="index.html">é¦–é </a>
    <a href="cosmic-post-station.html">å®‡å®™éƒµå±€</a>
    <a href="soulmirror.html">éˆé­‚ç…§å¦–é¡</a>
  </nav>

  <main style="max-width:1100px;margin:110px auto 60px;padding:0 16px;display:grid;grid-template-columns:280px 1fr;gap:18px;">
    <aside class="glass" style="padding:12px;border-radius:18px;">
      <img src="assets/trio_post1.webp" alt="" style="width:100%;display:block;border-radius:14px;margin-bottom:8px;">
      <img src="assets/trio_post2.webp" alt="" style="width:100%;display:block;border-radius:14px;margin-bottom:8px;">
      <img src="assets/ajin_post.webp" alt="" style="width:100%;display:block;border-radius:14px;margin-bottom:8px;">
      <img src="assets/migou_post.webp" alt="" style="width:100%;display:block;border-radius:14px;margin-bottom:8px;">
      <img src="assets/gungun_post.webp" alt="" style="width:100%;display:block;border-radius:14px;">
    </aside>

    <section>
      <div class="glass" style="padding:14px 16px;border-radius:18px;margin-bottom:12px;">
        <div style="display:flex;gap:12px;align-items:center;">
          <img src="assets/ajin_clear_post.webp" alt="" style="height:52px;">
          <img src="assets/migou_clear_post.webp" alt="" style="height:52px;">
          <img src="assets/gungun_clear_post.webp" alt="" style="height:52px;">
        </div>
      </div>

      <div id="thread" style="display:grid;gap:10px"></div>

      <div class="glass" style="display:flex;gap:8px;padding:10px 12px;border-radius:18px;margin-top:8px;">
        <input id="msg" placeholder="åœ¨æ˜Ÿéš›éš§é“æŠ•éä¸€å¥è©±ï¼›æŒ‰ Enter å‚³è¨Š..." style="flex:1;background:transparent;border:none;color:#e6f0ff;outline:none;font:400 14px 'Noto Sans TC'"/>
        <button id="send" class="nav-btn">â†’</button>
      </div>
    </section>
  </main>

  <script src="js/main.js"></script>
  <script>
  const personaOrder = ['Ajin','Migou','Gungun'];
  async function sendOnce(text){
    for(const who of personaOrder){
      const r = await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({persona:who,message:text})});
      const j = await r.json().catch(()=>({ok:false,reply:'(æ˜Ÿéš›è¨Šè™Ÿæš«æ™‚å¤±çœŸï¼Œç¨å¾Œå†è©¦)'}));
      bubble(who, j.ok ? j.reply : '(æ˜Ÿéš›è¨Šè™Ÿæš«æ™‚å¤±çœŸï¼Œç¨å¾Œå†è©¦)');
    }
    thread.scrollTo({top:thread.scrollHeight,behavior:'smooth'});
  }
  const thread = document.getElementById('thread');
  function bubble(who, text){
    const box = document.createElement('div');
    box.className = 'glass';
    box.style.padding='12px 14px'; box.style.borderRadius='18px'; box.style.color='#e6f0ff';
    const title = {Ajin:'ğŸ’› é˜¿é‡‘ AJIN', Migou:'ğŸ©· ç±³æœ MIGOU', Gungun:'ğŸ©µ æ»¾æ»¾ GUNGUN'}[who];
    box.innerHTML = '<div style="font-weight:900;margin-bottom:4px">'+title+'</div><div style="opacity:.95">'+text+'</div>';
    thread.appendChild(box);
  }
  const input = document.getElementById('msg');
  const btn = document.getElementById('send');
  input.addEventListener('keydown',e=>{ if(e.key==='Enter'){ const v=input.value.trim(); if(v){ sendOnce(v); input.value=''; } } });
  btn.addEventListener('click',()=>{ const v=input.value.trim(); if(v){ sendOnce(v); input.value=''; } });
  </script>
</body>
</html>
